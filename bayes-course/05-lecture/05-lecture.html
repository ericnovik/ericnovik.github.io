<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.335">

  <meta name="author" content="Eric Novik | Spring 2023 | Lecture 5">
  <title>Eric Novik - Bayesian Inference</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Bayesian Inference</h1>
  <p class="subtitle">NYU Applied Statistics for Social Science Research</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Eric Novik | Spring 2023 | Lecture 5 
</div>
</div>
</div>

</section>
<section id="linear-regression-and-model-evaluation" class="slide level2">
<h2>Linear Regression and Model Evaluation</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div>
<ul>
<li class="fragment">Introducing linear regression</li>
<li class="fragment">Prior predictive simulations</li>
<li class="fragment">Sampling from the posterior</li>
<li class="fragment">Example of linear regression in Stan</li>
<li class="fragment">Evaluating the quality of the draws</li>
<li class="fragment">Posterior predictions</li>
<li class="fragment">Cross validation, ELPD, and LOO</li>
</ul>
</div>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/stan.png" height="500"></p>
</figure>
</div>
</div>
</div>
<div class="cell">

</div>
<p><span class="math display">\[
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\P}{\mathbb{P}}
\DeclareMathOperator{\V}{\mathbb{V}}
\DeclareMathOperator{\L}{\mathcal{L}}
\DeclareMathOperator{\I}{\text{I}}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\]</span></p>
</section>
<section id="motivating-example" class="slide level2 smaller">
<h2>Motivating Example</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">We borrow this example from Richard McElreath’s Statistical Rethinking</li>
<li class="fragment">The data sets provided have been produced between 1969 to 2008, based on Nancy Howell’s observations of the !Kung San</li>
<li class="fragment">From Wikipedia: “The ǃKung are one of the San peoples who live mostly on the western edge of the Kalahari desert, Ovamboland (northern Namibia and southern Angola), and Botswana.”</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-right">
<figure>
<p><img data-src="images/kalahari.png"></p>
</figure>
</div>
</div>
</div>
<div class="footer">
<p><a href="https://tspace.library.utoronto.ca/handle/1807/10395">Univercity of Toronto Data Sets</a></p>
</div>
</section>
<section id="howell-dataset" class="slide level2 smaller">
<h2>Howell Dataset</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Data sample and summary:</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: right;">height</th>
<th style="text-align: right;">weight</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">151.765</td>
<td style="text-align: right;">47.82561</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">139.700</td>
<td style="text-align: right;">36.48581</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">136.525</td>
<td style="text-align: right;">31.86484</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">156.845</td>
<td style="text-align: right;">53.04191</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">145.415</td>
<td style="text-align: right;">41.27687</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">163.830</td>
<td style="text-align: right;">62.99259</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     height           weight            age       
 Min.   : 53.98   Min.   : 4.252   Min.   : 0.00  
 1st Qu.:125.09   1st Qu.:22.008   1st Qu.:12.00  
 Median :148.59   Median :40.058   Median :27.00  
 Mean   :138.26   Mean   :35.611   Mean   :29.34  
 3rd Qu.:157.48   3rd Qu.:47.209   3rd Qu.:43.00  
 Max.   :179.07   Max.   :62.993   Max.   :88.00  </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="05-lecture_files/figure-revealjs/unnamed-chunk-3-1.png" width="432"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="howell-dataset-1" class="slide level2 smaller">
<h2>Howell Dataset</h2>
<ul>
<li>There is an non-linear relationship between weigh and height</li>
<li>We will deal with that later</li>
<li>At this point, we will restrict our attention to addults (age &gt; 18)</li>
</ul>

<img data-src="05-lecture_files/figure-revealjs/unnamed-chunk-4-1.png" width="384" class="r-stretch quarto-figure-center"></section>
<section id="general-aproach" class="slide level2 smaller">
<h2>General Aproach</h2>
<div>
<ul>
<li class="fragment">Assess the scope of the inferences that you will get with this model</li>
<li class="fragment">In the case of linear regression, there is likely no causal mechanism and the coeficients should be intepreted as comparisons (RAOS, Page 84)</li>
<li class="fragment">Set up reasonable priors and likelihood</li>
<li class="fragment">Perform a prior predictive simualtion</li>
<li class="fragment">Adjust your priors</li>
<li class="fragment">Fit the model to data</li>
<li class="fragment">Assess quality of the inference and quality of the model</li>
<li class="fragment">Adjust your model</li>
</ul>
</div>
</section>
<section id="howell-regression" class="slide level2 smaller">
<h2>Howell Regression</h2>
<div>
<ul>
<li class="fragment">We will build a predictive model for adult Weight <span class="math inline">\(y\)</span> given Height <span class="math inline">\(x\)</span> using the Howell dataset</li>
<li class="fragment">Initial stab at the model: <span class="math display">\[
\begin{eqnarray}
y_i &amp; \sim &amp; \text{Normal}(\mu_i, \, \sigma)\\
\mu_i &amp; = &amp; \alpha + \beta x_i \\
\alpha &amp; \sim &amp; \text{Normal}(\alpha_{l}, \, \alpha_s) \\
\beta &amp; \sim &amp; \text{Normal}(\beta_{l}, \, \beta_s) \\
\sigma &amp; \sim &amp; \text{Exp}(r) \\
\end{eqnarray}
\]</span></li>
<li class="fragment">We have to specify <span class="math inline">\(\alpha_{l}\)</span> and <span class="math inline">\(\alpha_s\)</span>, where l and s signify location and scale, and r, the rate of the exponential</li>
<li class="fragment">If we work on the original scale for <span class="math inline">\(x\)</span>, it is awkward to choose a prior for the intercept : it correponds to the weight of the person with zero height</li>
<li class="fragment">This can be fixed by subtracting average height from <span class="math inline">\(x\)</span></li>
</ul>
</div>
</section>
<section id="howell-regression-1" class="slide level2 smaller">
<h2>Howell Regression</h2>
<div>
<ul>
<li class="fragment">We define a new variable, the centered version of <span class="math inline">\(x\)</span>: <span class="math inline">\(x^c_i = x_i - \bar{x}\)</span></li>
<li class="fragment">Now <span class="math inline">\(\alpha\)</span> corresponds to the weight of an average person</li>
<li class="fragment">Checking <a href="https://en.wikipedia.org/wiki/Human_body_weight">Wikipedia</a> reveals that average weight of a person in Africa is about 60 kg</li>
<li class="fragment">They don’t state the standard deviation but it is unlikely that an African adult would weigh less than 30 kg and more than 120 kg and so we will set the prior sd = 10 <span class="math display">\[
\begin{eqnarray}
y_i &amp; \sim &amp; \text{Normal}(\mu_i, \, \sigma)\\
\mu_i &amp; = &amp; \alpha + \beta x^c_i \\
\alpha &amp; \sim &amp; \text{Normal}(60, \, 10) \\
\beta &amp; \sim &amp; \text{Normal}(\beta_{l}, \, \beta_s) \\
\sigma &amp; \sim &amp; \text{Exp}(r) \\
\end{eqnarray}
\]</span></li>
<li class="fragment">What about the slope <span class="math inline">\(\beta\)</span>?</li>
</ul>
</div>
</section>
<section id="howell-regression-2" class="slide level2 smaller">
<h2>Howell Regression</h2>
<div>
<ul>
<li class="fragment">In this dataset, the units of <span class="math inline">\(\beta\)</span> are <span class="math inline">\(\frac{kg}{cm}\)</span>, since the units of height are <span class="math inline">\(cm\)</span></li>
<li class="fragment">First thing, <span class="math inline">\(\beta\)</span> should be positive. Why?</li>
<li class="fragment">Second, <span class="math inline">\(beta\)</span> is likely less than 1. Why?</li>
<li class="fragment">We can consult <a href="http://socr.ucla.edu/docs/resources/SOCR_Data/SOCR_Data_Dinov_020108_HeightsWeights.html">height-weight tables</a> for the expected value and variance</li>
<li class="fragment">In the dataset, <span class="math inline">\(\E(\beta) = 0.55\)</span> with a standard error of 0.006, but since we are uncertain how applicable that is to !Kung, we will allow the prior to vary more <span class="math display">\[
\begin{eqnarray}
y_i &amp; \sim &amp; \text{Normal}(\mu_i, \, \sigma)\\
\mu_i &amp; = &amp; \alpha + \beta x^c_i \\
\alpha &amp; \sim &amp; \text{Normal}(60, \, 10) \\
\beta &amp; \sim &amp; \text{Normal}(0.55, \, 0.1) \\
\sigma &amp; \sim &amp; \text{Exp}(r) \\
\end{eqnarray}
\]</span></li>
<li class="fragment">What about the error term <span class="math inline">\(\sigma\)</span>?</li>
</ul>
</div>
</section>
<section id="howell-regression-3" class="slide level2 smaller">
<h2>Howell Regression</h2>
<div>
<ul>
<li class="fragment">We know that <span class="math inline">\(\sigma\)</span> must be positive and so a possible choice for a the prior is <span class="math inline">\(\text{Normal}^+\)</span>, Exponential, etc.</li>
<li class="fragment">At this stage they key is rule out implausable values, not to get something precise, partcularly since we have enough data (&gt; 340 observations)</li>
<li class="fragment">From the background data, the residual standard error was 4.6, which implies the exponential rate parameter to be 0.2 <span class="math display">\[
\begin{eqnarray}
y_i &amp; \sim &amp; \text{Normal}(\mu_i, \, \sigma)\\
\mu_i &amp; = &amp; \alpha + \beta x^c_i \\
\alpha &amp; \sim &amp; \text{Normal}(60, \, 10) \\
\beta &amp; \sim &amp; \text{Normal}(0.55, \, 0.1) \\
\sigma &amp; \sim &amp; \text{Exp}(0.2) \\
\end{eqnarray}
\]</span></li>
<li class="fragment">We are now ready to perform a prior predictive simulation</li>
</ul>
</div>
</section>
<section id="prior-predictive-simulation" class="slide level2 smaller">
<h2>Prior Predictive Simulation</h2>
<ul>
<li>The simulation follows the generative process defined by the model</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-hash="05-lecture_cache/revealjs/unnamed-chunk-5_ece2b6fe8754811374c129cd627de2ef">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">mutate</span>(<span class="at">height_c =</span> height <span class="sc">-</span> <span class="fu">mean</span>(height))</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">round</span>(<span class="fu">mean</span>(d<span class="sc">$</span>height_c), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">head</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  height weight   age  male height_c
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1   152.   47.8    63     1    -2.83
2   140.   36.5    63     0   -14.9 
3   137.   31.9    65     0   -18.1 
4   157.   53.0    41     1     2.25
5   145.   41.3    51     0    -9.18
6   164.   63.0    35     1     9.23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>prior_pred <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb6-2"><a href="#cb6-2"></a>  alpha <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">60</span>, <span class="dv">10</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>  beta <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fl">0.55</span>, <span class="fl">0.1</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1</span>, <span class="fl">0.2</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>  l <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data); y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(l)</span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>l) {</span>
<span id="cb6-7"><a href="#cb6-7"></a>    mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> data<span class="sc">$</span>height_c[i]</span>
<span id="cb6-8"><a href="#cb6-8"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, mu, sigma)</span>
<span id="cb6-9"><a href="#cb6-9"></a>  }</span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="fu">return</span>(y)</span>
<span id="cb6-11"><a href="#cb6-11"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-hash="05-lecture_cache/revealjs/unnamed-chunk-6_7c4daeac57c5710019e6138b3a92c762">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>pr_p <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> n, <span class="fu">prior_pred</span>(d))</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># using library(purrr) functional primitives:</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># pr_p &lt;- map(1:n, \(i) prior_pred(d))</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="fu">dim</span>(pr_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 352 100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">round</span>(pr_p[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
 [1,] 50.02 49.35 67.40 50.84 40.34 47.49 67.09 39.72
 [2,] 46.98 43.39 62.40 53.24 34.19 47.66 62.79 32.45
 [3,] 45.60 41.89 62.17 53.54 34.27 47.21 61.63 30.93
 [4,] 50.96 51.11 69.22 57.28 41.94 58.24 68.66 42.54
 [5,] 48.87 45.78 65.16 52.88 36.66 51.49 64.78 36.91
 [6,] 52.35 54.13 71.59 61.06 44.36 56.78 71.32 47.25
 [7,] 48.64 47.73 66.35 56.74 38.62 44.15 66.08 37.69
 [8,] 55.56 56.36 74.16 55.90 45.27 53.42 73.19 50.21
 [9,] 50.09 47.26 65.32 51.37 39.50 52.89 65.69 39.02
[10,] 54.01 55.10 72.17 60.16 43.42 50.05 71.78 47.44
[11,] 52.27 49.91 67.93 61.93 41.40 48.83 67.93 41.93
[12,] 52.74 48.63 67.90 57.07 40.23 44.49 66.86 39.32</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="prior-predictive-simulation-1" class="slide level2 smaller">
<h2>Prior Predictive Simulation</h2>
<ul>
<li>To get a sense for the possible regression lines implied by the prior, we fit a linear model to each simulation draw and plot the lines over observations</li>
</ul>
<div class="cell columns column-output-location" data-layout-align="center">
<div class="column">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>intercepts <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb11-2"><a href="#cb11-2"></a>slopes <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb11-4"><a href="#cb11-4"></a>  coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm</span>(pr_p[, i] <span class="sc">~</span> d<span class="sc">$</span>height_c))</span>
<span id="cb11-5"><a href="#cb11-5"></a>  intercepts[i] <span class="ot">&lt;-</span> coefs[<span class="dv">1</span>]</span>
<span id="cb11-6"><a href="#cb11-6"></a>  slopes[i] <span class="ot">&lt;-</span> coefs[<span class="dv">2</span>]</span>
<span id="cb11-7"><a href="#cb11-7"></a>}</span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co"># using library(purrr) functional primitives:</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co"># df &lt;- pr_p |&gt; map_dfr(\(y) coef(lm(y ~ d$height_c)))</span></span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(height_c, weight), <span class="at">data =</span> d)</span>
<span id="cb11-13"><a href="#cb11-13"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">20</span>, <span class="dv">90</span>) <span class="sc">+</span> </span>
<span id="cb11-14"><a href="#cb11-14"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> slopes, </span>
<span id="cb11-15"><a href="#cb11-15"></a>              <span class="at">intercept =</span> intercepts, </span>
<span id="cb11-16"><a href="#cb11-16"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>  <span class="fu">ylab</span>(<span class="st">"Weight (kg)"</span>) <span class="sc">+</span> </span>
<span id="cb11-18"><a href="#cb11-18"></a>  <span class="fu">xlab</span>(<span class="st">"Centered Height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19"></a>  <span class="fu">ggtitle</span>(<span class="st">"Kalahari !Kung San people"</span>, </span>
<span id="cb11-20"><a href="#cb11-20"></a>          <span class="at">subtitle =</span> <span class="st">"Prior predictive simulation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="05-lecture_files/figure-revealjs/unnamed-chunk-7-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li><a href="https://www.polleverywhere.com/free_text_polls/ktA65I0m27uUAnCn44Cui">What do you notice about this prior?</a></li>
</ul>
</section>
<section id="deriving-a-posterior-distribution" class="slide level2 smaller">
<h2>Deriving a Posterior Distribution</h2>
<div>
<ul>
<li class="fragment">We have seen how to derive posterior and posterior predictive distribution</li>
<li class="fragment">There is nothing new here, except we are dealing a three dimentional posterior: <span class="math inline">\(f(\alpha, \beta, \sigma)\)</span>. What happened to <span class="math inline">\(\mu\)</span>?</li>
<li class="fragment">We construct the posterior from the prior and data likelihood (for each <span class="math inline">\(y_i\)</span>): <span class="math display">\[
\begin{eqnarray}
&amp;\text{Prior: }f(\alpha, \beta, \sigma) = f_1(\alpha) f_2(\beta) f_3(\sigma) \\
&amp;\text{Likelihood: }f(y \mid \alpha, \beta, \sigma) = \prod_{i=1}^{n}f_4(y_i \mid \alpha, \beta, \sigma) \\
&amp;\text{Posterior: }f(\alpha,\beta,\sigma \mid y) = \frac{f_1(\alpha) f(_2\beta) f_3(\sigma) \cdot \left[\prod_{i=1}^{n}f_4(y_i \mid \alpha, \beta, \sigma) \right]}
{\int\int\int f_1(\alpha) f_2(\beta) f_3(\sigma) \cdot \left[\prod_{i=1}^{n}f_4(y_i \mid \alpha, \beta, \sigma) \right] d\alpha \, d\beta \, d\sigma}
\end{eqnarray}
\]</span></li>
<li class="fragment">To be more precise, we would indicate that <span class="math inline">\(f_1, f_2\)</span> and <span class="math inline">\(f_4\)</span> are Normal with different parameters, and <span class="math inline">\(f_3\)</span> is <span class="math inline">\(\text{Exp}(0.2)\)</span></li>
</ul>
</div>
</section>
<section id="fitting-the-model" class="slide level2 smaller">
<h2>Fitting the Model</h2>
<div>
<ul>
<li class="fragment">Even though our prior is slighly off, 300+ observations is a lot in this case (big data!), and so we proceed to model fitting</li>
<li class="fragment">We will use <code>stan_glm()</code> function in <code>rstanarm</code></li>
<li class="fragment"><code>rstanarm</code> has default priors, but you should specify your own:</li>
</ul>
<div class="cell">

</div>
<div class="cell" data-hash="05-lecture_cache/revealjs/unnamed-chunk-9_b783c178d26442b947754d599d8dd7a2">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a>m1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(</span>
<span id="cb12-6"><a href="#cb12-6"></a>  weight <span class="sc">~</span> height_c,</span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="at">data =</span> d,</span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">60</span>, <span class="dv">10</span>),</span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="at">prior =</span> <span class="fu">normal</span>(<span class="fl">0.55</span>, <span class="fl">0.1</span>),</span>
<span id="cb12-11"><a href="#cb12-11"></a>  <span class="at">prior_aux =</span> <span class="fu">exponential</span>(<span class="fl">0.2</span>),</span>
<span id="cb12-12"><a href="#cb12-12"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="at">iter =</span> <span class="dv">500</span>,</span>
<span id="cb12-14"><a href="#cb12-14"></a>  <span class="at">seed =</span> <span class="dv">1234</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li class="fragment">By default, <code>rstanarm</code> samples from the posterior. To get back the prior predictive distribution (instead of doing it in R) use <code>prior_PD = TRUE</code></li>
</ul>
</div>
</section>
<section id="looking-at-the-model-summary" class="slide level2 smaller">
<h2>Looking at the Model Summary</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Info:
 function:     stan_glm
 family:       gaussian [identity]
 formula:      weight ~ height_c
 algorithm:    sampling
 sample:       1000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 352
 predictors:   2

Estimates:
              mean   sd   10%   50%   90%
(Intercept) 45.0    0.2 44.7  45.0  45.3 
height_c     0.6    0.0  0.6   0.6   0.7 
sigma        4.2    0.2  4.0   4.2   4.5 

Fit Diagnostics:
           mean   sd   10%   50%   90%
mean_PPD 45.0    0.3 44.6  45.0  45.4 

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
              mcse Rhat n_eff
(Intercept)   0.0  1.0  824  
height_c      0.0  1.0  994  
sigma         0.0  1.0  867  
mean_PPD      0.0  1.0  970  
log-posterior 0.1  1.0  459  

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
</div>
</div>
<ul>
<li>If you can examine the priors by running <code>prior_summary(m1)</code></li>
</ul>
</section>
<section id="evaluting-quality-of-the-inferences" class="slide level2 smaller">
<h2>Evaluting Quality of the Inferences</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">neff_ratio</span>(m1) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    height_c       sigma 
       0.82        0.99        0.87 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">rhat</span>(m1) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    height_c       sigma 
          1           1           1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">mcmc_trace</span>(m1, <span class="at">size =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05-lecture_files/figure-revealjs/unnamed-chunk-11-1.png" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="same-model-in-stan" class="slide level2 smaller">
<h2>Same Model in Stan</h2>
<div class="cell" data-output.var="stan1">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">data</span> {</span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; N;</span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="dt">vector</span>[N] x;</span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="dt">vector</span>[N] y;</span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">1</span>&gt; prior_PD;</span>
<span id="cb20-6"><a href="#cb20-6"></a>}</span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="kw">parameters</span> {</span>
<span id="cb20-8"><a href="#cb20-8"></a>  <span class="dt">real</span> alpha;</span>
<span id="cb20-9"><a href="#cb20-9"></a>  <span class="dt">real</span> beta;</span>
<span id="cb20-10"><a href="#cb20-10"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;</span>
<span id="cb20-11"><a href="#cb20-11"></a>}</span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb20-13"><a href="#cb20-13"></a>  <span class="dt">vector</span>[N] mu = alpha + beta * x;</span>
<span id="cb20-14"><a href="#cb20-14"></a>}</span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="kw">model</span> {</span>
<span id="cb20-16"><a href="#cb20-16"></a>  alpha ~ normal(<span class="dv">60</span>, <span class="dv">10</span>);</span>
<span id="cb20-17"><a href="#cb20-17"></a>  beta ~ normal(<span class="fl">0.55</span>, <span class="fl">0.1</span>);</span>
<span id="cb20-18"><a href="#cb20-18"></a>  sigma ~ exponential(<span class="fl">0.2</span>);</span>
<span id="cb20-19"><a href="#cb20-19"></a>  <span class="cf">if</span> (!prior_PD) {</span>
<span id="cb20-20"><a href="#cb20-20"></a>    y ~ normal(mu, sigma);</span>
<span id="cb20-21"><a href="#cb20-21"></a>  }</span>
<span id="cb20-22"><a href="#cb20-22"></a>}</span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="kw">generated quantities</span> {</span>
<span id="cb20-24"><a href="#cb20-24"></a>  <span class="dt">array</span>[N] <span class="dt">real</span> y_tilde = normal_rng(mu, sigma);</span>
<span id="cb20-25"><a href="#cb20-25"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>You can pass <code>prior_PD</code> as a flag enable drawing from prior predictive distribution</li>
</ul>
</section>
<section id="prior-vs-posterior" class="slide level2 smaller">
<h2>Prior vs Posterior</h2>
<div>
<ul>
<li class="fragment">Comparing the prior to the posterior tell us how much the model learned from data</li>
<li class="fragment">It also helps us to validate if our priors were reasonable</li>
<li class="fragment">In <code>rstanarm</code>, you can use <code>posterior_vs_prior</code> function</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="05-lecture_files/figure-revealjs/unnamed-chunk-13-1.png" width="1152"></p>
</figure>
</div>
</div>
</div>
<ul>
<li class="fragment">Your prior should cover the plausable range of parameter values</li>
<li class="fragment">When we don’t have a lot of data and parameters are complex, setting good priors takes work, but there are <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">guidelines</a></li>
</ul>
</div>
</section>
<section id="examining-the-posterior" class="slide level2 smaller">
<h2>Examining the Posterior</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a>draws <span class="ot">&lt;-</span> <span class="fu">spread_draws</span>(m1, <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>, height_c, sigma)</span>
<span id="cb21-4"><a href="#cb21-4"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(<span class="fu">round</span>(draws, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: right;">.chain</th>
<th style="text-align: right;">.iteration</th>
<th style="text-align: right;">.draw</th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">height_c</th>
<th style="text-align: right;">sigma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">44.97</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">4.09</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">45.06</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">4.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">45.02</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">4.13</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">45.07</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">4.32</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">44.66</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">4.38</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">45.31</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">4.12</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<ul>
<li class="fragment"><code>spread_draws</code> will arrange the inferences in columns (wide format)</li>
<li class="fragment"><code>gather_draws</code> will arrange the inferences in rows (long format), which is usually more convenient for plotting and computation</li>
</ul>
</div>
</section>
<section id="examining-the-posterior-1" class="slide level2 smaller">
<h2>Examining the Posterior</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>draws <span class="ot">&lt;-</span> <span class="fu">gather_draws</span>(m1, <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>, height_c, sigma)</span>
<span id="cb22-3"><a href="#cb22-3"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tail</span>(draws, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: right;">.chain</th>
<th style="text-align: right;">.iteration</th>
<th style="text-align: right;">.draw</th>
<th style="text-align: left;">.variable</th>
<th style="text-align: right;">.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">247</td>
<td style="text-align: right;">997</td>
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">4.09</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">248</td>
<td style="text-align: right;">998</td>
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">4.22</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">249</td>
<td style="text-align: right;">999</td>
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">4.20</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">1000</td>
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">4.11</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>draws <span class="sc">|&gt;</span> <span class="fu">mean_qi</span>(<span class="at">.width =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>() <span class="co"># also see ?median_qi(), etc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">.variable</th>
<th style="text-align: right;">.value</th>
<th style="text-align: right;">.lower</th>
<th style="text-align: right;">.upper</th>
<th style="text-align: right;">.width</th>
<th style="text-align: left;">.point</th>
<th style="text-align: left;">.interval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">45.000</td>
<td style="text-align: right;">44.635</td>
<td style="text-align: right;">45.36</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: left;">mean</td>
<td style="text-align: left;">qi</td>
</tr>
<tr class="even">
<td style="text-align: left;">height_c</td>
<td style="text-align: right;">0.624</td>
<td style="text-align: right;">0.576</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: left;">mean</td>
<td style="text-align: left;">qi</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">4.250</td>
<td style="text-align: right;">3.996</td>
<td style="text-align: right;">4.53</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: left;">mean</td>
<td style="text-align: left;">qi</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>From the above table: <span class="math inline">\(\E(y|x^c) = 45 (\text{kg}) + 0.62 (\text{kg/cm})x^c (\text{cm})\)</span></li>
</ul>
</section>
<section id="variability-in-parameter-inferences" class="slide level2 smaller">
<h2>Variability in Parameter Inferences</h2>
<ul>
<li>The code in section 9.4 in the book doesn’t work as the function and variable names have changed</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>dpred <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="co"># same as add_epred_draws for lin reg not not for other GLMs</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">add_linpred_draws</span>(m1, <span class="at">ndraws =</span> <span class="dv">50</span>)</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="fu">head</span>(dpred, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 10
# Groups:   height, weight, age, male, height_c, .row [1]
  height weight   age  male height_c  .row .chain .iteration .draw .linpred
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
1   152.   47.8    63     1    -2.83     1     NA         NA     1     43.4
2   152.   47.8    63     1    -2.83     1     NA         NA     2     43.0
3   152.   47.8    63     1    -2.83     1     NA         NA     3     42.9</code></pre>
</div>
</div>
<div class="cell columns column-output-location" data-layout-align="center">
<div class="column">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>dpred <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height_c, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .linpred, <span class="at">group =</span> .draw), </span>
<span id="cb26-3"><a href="#cb26-3"></a>            <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d, <span class="at">size =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">ylab</span>(<span class="st">"Weight (kg)"</span>) <span class="sc">+</span> </span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="fu">xlab</span>(<span class="st">"Centered Height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="fu">ggtitle</span>(<span class="st">"100 draws from the slope/intercept posterior"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="05-lecture_files/figure-revealjs/unnamed-chunk-17-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="posterior-predictions" class="slide level2 smaller">
<h2>Posterior Predictions</h2>
</section>
<section id="posterior-predictions-1" class="slide level2 smaller">
<h2>Posterior Predictions</h2>
</section>
<section id="evaluting-quality-of-the-predictions" class="slide level2">
<h2>Evaluting Quality of the Predictions</h2>

<div class="footer footer-default">
<p><a href="https://ericnovik.github.io/bayes-course.html" class="uri">https://ericnovik.github.io/bayes-course.html</a></p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false,"chalkWidth":5},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>