<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Eric Novik">
  <title>Eric Novik – Bayesian Inference</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-e829f46d6c6374dd212fea2563f89f04.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Bayesian Inference</h1>
  <p class="subtitle">NYU Applied Statistics for Social Science Research</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Eric Novik 
</div>
<div class="quarto-title-author-email">
<a href="mailto:Spring 2025 | Lecture 1">Spring 2025 | Lecture 1</a>
</div>
        <p class="quarto-title-affiliation">
            New York University
          </p>
        <p class="quarto-title-affiliation">
            Generable Inc.
          </p>
    </div>
</div>

</section>
<section id="introductions" class="slide level2">
<h2>Introductions</h2>
<ul>
<li><a href="https://www.polleverywhere.com/free_text_polls/j8542cMkfw1Z7cxNGvsc6">What is the city of your birth?</a></li>
</ul>

<img data-src="images/van-gogh-moon.webp" class="quarto-figure quarto-figure-center r-stretch" width="500"><p><span class="math display">\[
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\P}{\mathbb{P}}
\DeclareMathOperator{\V}{\mathbb{V}}
\DeclareMathOperator{\L}{\mathscr{L}}
\DeclareMathOperator{\I}{\text{I}}
\]</span></p>
</section>
<section id="two-truths-and-a-lie1" class="slide level2 smaller scrollable">
<h2>Two Truths and a Lie<sup>1</sup></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>One person tells three personal statements, one of which is a lie.</li>
<li>Others discuss and guess which statement is the lie, and they jointly construct a numerical statement of their certainty in the guess (on a 0–10 scale).</li>
<li>The storyteller reveals which was the lie.</li>
<li>Enter the certainty number and the outcome (success or failure) and submit in the Google form. Rotate through everyone in your group so that each person plays the storyteller role once.</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/two-truths.png" class="quarto-figure quarto-figure-center" width="500"></p>
</figure>
</div>
</div></div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Gelman, A. (2023). “Two Truths and a Lie” as a Class-Participation Activity. The American Statistician, 77(1), 97–101.</p></li></ol></aside></section>
<section id="two-truths-and-a-lie" class="slide level2">
<h2>Two Truths and a Lie</h2>
<p>https://tinyurl.com/two-truths-and</p>

<img data-src="images/two-truths-and-400.png" class="quarto-figure quarto-figure-center r-stretch" width="500"><aside class="notes">
<p>What do you think the range of certainty scores will look like: will there be any 0’s or 10’s? Will there be a positive relation between x and y: are guesses with higher certainty be more accurate, on average? How strong will the relation be between x and y: what will the curve look like? Give approximate numerical values for the intercept and slope coefficients corresponding to their sketched curves.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="lecture-1-bayesian-workflow" class="slide level2 smaller">
<h2>Lecture 1: Bayesian Workflow</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Two Truths and a Lie</li>
<li class="fragment">Statistics vs AI/ML</li>
<li class="fragment">Brief history of Bayesian inference</li>
<li class="fragment">Review of basic probability</li>
<li class="fragment">Introduction to Bayesian workflow</li>
<li class="fragment">Bayes’s rule for events</li>
<li class="fragment">Binomial model and the Bayesian Crank</li>
<li class="fragment">Overview of the Course</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/road.webp" class="quarto-figure quarto-figure-center" width="500"></p>
</figure>
</div>
</div></div>
</section>
<section id="statistics-vs.-aiml" class="slide level2 smaller">
<h2>Statistics vs.&nbsp;AI/ML</h2>
<p>⚠️ What follows is an oversimplified opinion.</p>
<div>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">AI is great for <strong>automating tasks</strong> that humans find <em>easy</em>
<ul>
<li class="fragment">Recognizing faces, cats, and other objects</li>
<li class="fragment">Identifying tumors on a radiology scan</li>
<li class="fragment">Playing Chess and Go</li>
<li class="fragment">Driving a car</li>
<li class="fragment">Post ChatGPT 4: Generating coherent text/images/video, signs of reasoning</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment">Statistics is great at <strong>answering questions</strong> that humans find hard
<ul>
<li class="fragment">How fast does a drug clear from the body?</li>
<li class="fragment">What is the expected tumor size two months after treatment?</li>
<li class="fragment">How would patients respond under a different treatment?</li>
<li class="fragment">Should I take this drug?</li>
<li class="fragment">Should we (FDA/EMA/…) approve this drug?</li>
</ul></li>
</ul>
</div></div>

</div>
<aside class="notes">
<ul>
<li>These are speaker notes for this slide.</li>
<li>You can add multiple lines of notes. You can include bullets and not bullets And latex: <span class="math inline">\(y = f(x)\)</span> <span class="math inline">\(z = f(g)\)</span></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside><div>
<p>“Machine learning excels when you have lots of training data that can be reasonably modeled as exchangeable with your test data; Bayesian inference excels when your data are sparse and your model is dense.” — Andrew Gelman</p>
</div></aside></section>
<section id="brief-history" class="slide level2 smaller">
<h2>Brief History</h2>
<p><a href="https://www.lesswrong.com/posts/RTt59BtFLqQbsSiqd/a-history-of-bayes-theorem">Summary</a> of the book <a href="https://www.amazon.com/Theory-That-Would-Not-Die/dp/0300169698/">The Theory That Would Not Die</a></p>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Thomas Bayes (1702(?) — 1761) is credited with the discovery of the “Bayes’s Rule”</li>
<li class="fragment">His paper was published posthumously by Richard Price in 1763</li>
<li class="fragment">Laplace (1749 — 1827) independently discovered the rule and published it in 1774</li>
<li class="fragment">Scientific context: Newton’s Principia was published in 1687</li>
<li class="fragment">Bayesian wins: German Enigma cipher, search for a missing H-bomb, Federalist papers, Moneyball, FiveThirtyEight</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/bayes.png" class="quarto-figure quarto-figure-center" width="672"></p>
</figure>
</div>
</div></div>
<aside class="notes">
<p>Stephen Stigler gives 3:1 in favor of Nicholas Saunderson for the discovery of Bayes’s [sic] rule.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="laplaces-demon" class="slide level2 smaller">
<h2>Laplace’s Demon</h2>
<div class="columns">
<div class="column" style="width:50%;">
<blockquote>
<p>We may regard the present state of the universe as the effect of its past and the cause of its future. An intellect which at any given moment knew all of the forces that animate nature and the mutual positions of the beings that compose it, if this intellect were vast enough to submit the data to analysis, could condense into a single formula the movement of the greatest bodies of the universe and that of the lightest atom; for such an intellect <strong>nothing could be uncertain</strong>, and the future just like the past would be present before its eyes.</p>
</blockquote>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/laplace.jpeg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
<p>Marquis Pierre Simon de Laplace (1729 — 1827)</p>
<p>“Uncertainty is a function of our ignorance, not a property of the world.”</p>
</div></div>
</section>
<section id="modern-examples-of-bayesian-analyses" class="slide level2">
<h2>Modern Examples of Bayesian Analyses</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/laplace-modern.png" class="quarto-figure quarto-figure-center" width="500"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/laplace.webp" class="quarto-figure quarto-figure-center" width="500"></p>
</figure>
</div>
</div></div>
<div class="footer">
<p>Left: Pierre Simon Laplace in the style of Wassily Kandinsky, by OpenAI DALL·E</p>
</div>
</section>
<section id="elasticity-of-demand-stan-with-hierarchical-model" class="slide level2">
<h2>Elasticity of Demand (Stan with Hierarchical Model)</h2>

<img data-src="images/books.png" class="quarto-figure quarto-figure-center r-stretch" width="100"></section>
<section id="pharmacometrics-stan-with-odes" class="slide level2">
<h2>Pharmacometrics (Stan with ODEs)</h2>

<img data-src="images/pk.png" class="quarto-figure quarto-figure-center r-stretch" width="100"></section>
<section id="nonparametric-bayes-stan-with-gps" class="slide level2">
<h2>Nonparametric Bayes (Stan with GPs)</h2>

<img data-src="images/gp.png" class="quarto-figure quarto-figure-center r-stretch" width="100"><div class="footer">
<p>Timonen, J., Mannerström, H., Vehtari, A., &amp; Lähdesmäki, H. (2021). lgpr: An interpretable non-parametric method for inferring covariate effects from longitudinal data. Bioinformatics, 37(13), 1860–1867. https://doi.org/10.1093/bioinformatics/btab021</p>
</div>
</section>
<section id="review-of-probability" class="slide level2">
<h2>Review of Probability</h2>
<div>
<ul>
<li class="fragment">A set of all possible outcomes is called a sample space and denoted by <span class="math inline">\(\Omega\)</span></li>
<li class="fragment">An outcome of an experiment is denoted by <span class="math inline">\(\omega \in \Omega\)</span></li>
<li class="fragment">We typically denote events by capital letters, say <span class="math inline">\(A \subseteq \Omega\)</span></li>
<li class="fragment">Axioms of probability:
<ul>
<li class="fragment"><span class="math inline">\(\P(A) \geq 0, \, \text{for all } A\)</span></li>
<li class="fragment"><span class="math inline">\(\P(\Omega) = 1\)</span></li>
<li class="fragment">If <span class="math inline">\(A_1, A_2, A_3, \ldots\)</span> are disjoint: <span class="math inline">\(\P(\cup_{i=1}^{\infty} A_i) = \sum_{i=1}^{\infty} \P(A_i)\)</span></li>
</ul></li>
</ul>
</div>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Rolling dice</a></li><li><a href="#tabset-1-2">Omega</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div>
<ul>
<li class="fragment">You roll a fair six-sided die twice</li>
<li class="fragment"><a href="https://www.polleverywhere.com/free_text_polls/hbp5mikDZQuaAUY93DxEe">Give an example</a> of an <span class="math inline">\(\omega \in \Omega\)</span></li>
<li class="fragment"><a href="https://www.polleverywhere.com/free_text_polls/ei1LTjb0Hs527FmxOYcyz">How many elements</a> are in <span class="math inline">\(\Omega\)</span>? What is <span class="math inline">\(\Omega\)</span>?</li>
<li class="fragment">Define an event <span class="math inline">\(A\)</span> as the sum of the two rolls less than 11</li>
<li class="fragment">How many elements are in <span class="math inline">\(A\)</span>?</li>
<li class="fragment"><a href="https://www.polleverywhere.com/free_text_polls/jeW2aLcvHLARVmmUlcshY">What is</a> <span class="math inline">\(\P(A)\)</span>?</li>
</ul>
</div>
</div>
<div id="tabset-1-2">
<div class="columns">
<div class="column" style="width:46%;">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">outer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">FUN =</span> <span class="st">"+"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    2    3    4    5    6    7
[2,]    3    4    5    6    7    8
[3,]    4    5    6    7    8    9
[4,]    5    6    7    8    9   10
[5,]    6    7    8    9   10   11
[6,]    7    8    9   10   11   12</code></pre>
</div>
</div>
</div>
<div>
<ul>
<li class="fragment"><span class="math inline">\(\Omega\)</span> consists of all pairs:
<ul>
<li class="fragment"><span class="math inline">\(\{(1, 1), (1, 2), ... (2, 1), (2, 2), ...\}\)</span></li>
</ul></li>
</ul>
</div>
</div><div class="column" style="width:54%;">
<div>
<ul>
<li class="fragment">There are 36 such pairs</li>
<li class="fragment">33 of those pairs result in a sum of less than 11</li>
<li class="fragment"><span class="math inline">\(\P(A) = \frac{33}{36} = \frac{11}{12}\)</span></li>
</ul>
</div>
</div></div>
</div>
</div>
</div>
</section>
<section id="random-variables-review" class="slide level2">
<h2>Random Variables Review</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Review</a></li><li><a href="#tabset-2-2">Mapping</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div>
<ul>
<li class="fragment">Random variable is not random – it is a deterministic mapping from the sample space onto the real line; randomness comes from the experiment</li>
<li class="fragment">PMF, PDF, CDF (Blitzstein and Hwang, Ch. 3, 5)</li>
<li class="fragment">Expectations (Blitzstein and Hwang, Ch. 4)</li>
<li class="fragment">Joint Distributions (Blitzstein and Hwang, Ch. 7)</li>
<li class="fragment">Conditional Expectations (Blitzstein and Hwang, Ch. 9)</li>
</ul>
</div>
</div>
<div id="tabset-2-2">
<p>Random variable X for the number of Heads in two flips</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/nofheads.png" class="quarto-figure quarto-figure-center" height="400"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="example-simulation" class="slide level2 smaller">
<h2>Example Simulation</h2>
<div>
<ul>
<li class="fragment">We will use R’s <code>sample()</code> function to simulate rolls of a die and <code>replicate()</code> function to repeat the rolling process many times</li>
<li class="fragment">Modern approach: <code>purrr::map(1:n, \(x) expression)</code></li>
</ul>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>die <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb3-2"><a></a>roll <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n) {</span>
<span id="cb3-3"><a></a>  <span class="fu">sample</span>(x, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-4"><a></a>}</span>
<span id="cb3-5"><a></a><span class="fu">roll</span>(die, <span class="dv">2</span>) <span class="co"># roll the die twice</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>rolls <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="fl">1e4</span>, <span class="fu">roll</span>(die, <span class="dv">2</span>))</span>
<span id="cb5-2"><a></a>rolls[, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>] <span class="co"># print first 8 columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
[1,]    6    4    1    6    6    2    5    1
[2,]    6    5    5    3    2    1    1    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>roll_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(rolls)</span>
<span id="cb7-2"><a></a><span class="fu">head</span>(roll_sums)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12  9  6  9  8  3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="fu">mean</span>(roll_sums <span class="sc">&lt;</span> <span class="dv">11</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9159</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Given a Random Variable <span class="math inline">\(Y\)</span>, <span class="math inline">\(y^{(1)}, y^{(2)}, y^{(3)}, \ldots, y^N\)</span> are simulations or draws from <span class="math inline">\(Y\)</span></li>
<li class="fragment">Fundamental bridge (Blitzstein &amp; Hwang p.&nbsp;164): <span class="math inline">\(\P(A) = \E(\I_A)\)</span></li>
<li class="fragment">Computationally: <span class="math inline">\(\P(Y &lt; 11) \approx \frac{1}{N} \sum^{N}_{n=1} \I(y^n &lt; 11)\)</span></li>
<li class="fragment">In R, <code>roll_sums &lt; 11</code> creates an indicator variable</li>
<li class="fragment">And <code>mean()</code> does the average</li>
</ul>
</div>
</div></div>
</section>
<section id="example-simulation-with-purrr" class="slide level2 smaller">
<h2>Example Simulation with purrr</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Roll a die twice, twenty times</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>sim <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, \(x) <span class="fu">roll</span>(die, <span class="dv">2</span>))</span>
<span id="cb11-2"><a></a><span class="fu">str</span>(sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 20
 $ : int [1:2] 6 2
 $ : int [1:2] 4 4
 $ : int [1:2] 5 2
 $ : int [1:2] 6 2
 $ : int [1:2] 5 2
 $ : int [1:2] 5 1
 $ : int [1:2] 3 6
 $ : int [1:2] 3 4
 $ : int [1:2] 4 4
 $ : int [1:2] 3 2
 $ : int [1:2] 2 2
 $ : int [1:2] 5 6
 $ : int [1:2] 5 2
 $ : int [1:2] 4 2
 $ : int [1:2] 6 1
 $ : int [1:2] 4 1
 $ : int [1:2] 5 4
 $ : int [1:2] 1 2
 $ : int [1:2] 4 2
 $ : int [1:2] 3 2</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Roll a die once, twice, …., twenty times</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>sim <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, \(x) <span class="fu">roll</span>(die, x))</span>
<span id="cb13-2"><a></a><span class="fu">str</span>(sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 20
 $ : int 6
 $ : int [1:2] 4 1
 $ : int [1:3] 1 2 3
 $ : int [1:4] 1 4 5 2
 $ : int [1:5] 6 2 3 4 4
 $ : int [1:6] 5 3 4 5 4 1
 $ : int [1:7] 1 5 4 5 5 4 3
 $ : int [1:8] 1 6 5 6 4 4 3 4
 $ : int [1:9] 3 3 6 6 5 1 4 1 6
 $ : int [1:10] 1 6 5 5 3 4 5 1 3 5
 $ : int [1:11] 4 4 2 4 6 2 1 2 2 3 ...
 $ : int [1:12] 2 3 2 6 4 2 6 3 3 4 ...
 $ : int [1:13] 2 3 2 2 2 5 1 3 6 2 ...
 $ : int [1:14] 3 2 6 4 2 1 3 2 6 6 ...
 $ : int [1:15] 3 4 3 5 1 6 1 2 5 4 ...
 $ : int [1:16] 6 2 2 6 2 6 3 5 2 6 ...
 $ : int [1:17] 3 5 3 6 5 4 2 1 5 2 ...
 $ : int [1:18] 5 1 3 6 6 6 6 3 4 6 ...
 $ : int [1:19] 5 5 6 1 6 5 1 2 4 3 ...
 $ : int [1:20] 4 6 4 3 4 3 4 3 5 1 ...</code></pre>
</div>
</div>
</div>
</div></div>
</section>
<section id="review-of-conditional-probability" class="slide level2">
<h2>Review of Conditional Probability</h2>
<div>
<ul>
<li class="fragment">For arbitrary <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, if <span class="math inline">\(\P(B) &gt; 0\)</span>:
<ul>
<li class="fragment">Conditional probability: <span class="math inline">\(\P(A \mid B) = \frac{\P(AB)}{\P(B)}\)</span></li>
<li class="fragment">Conditional probability: <span class="math inline">\(\P(B \mid A) = \frac{\P(AB)}{\P(A)}\)</span></li>
</ul></li>
<li class="fragment">Bayes’s rule: <span class="math inline">\(\P(A \mid B) = \frac{\P(AB)}{\P(B)} = \frac{\P(B \mid A) \P(A)}{\P(B)}\)</span></li>
<li class="fragment"><span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent if observing <span class="math inline">\(B\)</span> does not give you any more information about <span class="math inline">\(A\)</span>: <span class="math inline">\(\P(A \mid B) = \P(A)\)</span></li>
<li class="fragment">And <span class="math inline">\(\P(A B) = \P(A) \P(B)\)</span> (from Bayes’s rule)</li>
</ul>
</div>
</section>
<section id="joint-marginal-and-conditional" class="slide level2 smaller">
<h2>Joint, Marginal, and Conditional</h2>
<div>
<ul>
<li class="fragment">Titanic carried approximately 2,200 passengers and sank on 15 April 1912</li>
<li class="fragment">Let <span class="math inline">\(G: \{m, f\}\)</span> represent Gender and <span class="math inline">\(S: \{n, y\}\)</span> represent Survival</li>
</ul>
</div>
<div class="fragment">
<div class="cell columns column-output-location" data-layout-align="center" data-class.code="small-code">
<div class="column">
<div class="sourceCode cell-code" id="cb15" data-code-line-numbers="|1|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>surv <span class="ot">&lt;-</span> <span class="fu">apply</span>(Titanic, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), sum) </span>
<span id="cb15-2"><a></a>surv_prop <span class="ot">&lt;-</span> <span class="fu">round</span>(surv <span class="sc">/</span> <span class="fu">sum</span>(surv), <span class="dv">3</span>)</span>
<span id="cb15-3"><a></a><span class="fu">bind_cols</span>(<span class="at">Sex =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>), surv_prop) <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a></a>  janitor<span class="sc">::</span><span class="fu">adorn_totals</span>(<span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> </span>
<span id="cb15-6"><a></a>         <span class="st">"Titanic survival proportions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<table class="caption-top">
<caption>Titanic survival proportions</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Sex</th>
<th style="text-align: right;">No</th>
<th style="text-align: right;">Yes</th>
<th style="text-align: right;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.787</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.213</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">0.677</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div></div>
</div>
<div>
<ul>
<li class="fragment"><span class="math inline">\(\P(G = m \cap S = y) =\)</span> 0.167</li>
<li class="fragment"><span class="math inline">\(\P(S = y) = \sum_{i \in \{m, f\}} \P(S = y \, \cap G = i) =\)</span> ??</li>
<li class="fragment"><span class="math inline">\(\P(S = y) = \sum_{i \in \{m, f\}} \P(S = y \, \cap G = i) = 0.323\)</span></li>
</ul>
</div>
</section>
<section id="joint-marginal-and-conditional-1" class="slide level2 tiny">
<h2>Joint, Marginal, and Conditional</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div>
<ul>
<li class="fragment">What is <span class="math inline">\(\P(G = m \mid S = y)\)</span>, probability of being <br> male given survival?</li>
<li class="fragment">To compute that, we only consider the column <br> where Survival = Yes</li>
<li class="fragment"><span class="math inline">\(\P(G = m \mid S = y) = \frac{\P(G = m \, \cap \, S = y)}{\P(S = y)} = \frac{0.167}{0.323} \\ \approx 0.52\)</span></li>
<li class="fragment">You want <span class="math inline">\(\P(S = y \mid G = m)\)</span>, comparing it to <span class="math inline">\(\\ \qquad \ \ \ \ \ \ \P(S = y \mid G = f)\)</span></li>
<li class="fragment"><span class="math inline">\(\P(S = y \mid G = m) = \frac{\P(G = m \, \cap \, S = y)}{\P(G = m)} = \frac{0.167}{0.787} \\ \approx 0.21\)</span></li>
<li class="fragment"><span class="math inline">\(\P(S = y \mid G = f) = \frac{\P(G = f \, \cap \, S = y)}{\P(G = f)} = \frac{0.156}{0.213} \\ \approx 0.73\)</span></li>
<li class="fragment">How would you compute <span class="math inline">\(\P(S = n \mid G = m)\)</span>?</li>
<li class="fragment"><span class="math inline">\(\P(S = n \mid G = m) = 1 - \P(S = y \mid G = m)\)</span></li>
</ul>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-layout-align="right">
<div class="cell-output-display">
<table class="caption-top">
<caption>Titanic survival proportions</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Sex</th>
<th style="text-align: right;">No</th>
<th style="text-align: right;">Yes</th>
<th style="text-align: right;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: right;">0.620</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.787</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.213</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">0.677</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><img data-src="images/titanic.jpeg" class="quarto-figure quarto-figure-right"> “Untergang der Titanic”, as conceived by Willy Stöwer, 1912</p>
</div></div>
</section>
<section id="law-of-total-probability-lotp" class="slide level2">
<h2>Law of Total Probability (LOTP)</h2>
<p>Let <span class="math inline">\(A\)</span> be a partition of <span class="math inline">\(\Omega\)</span>, so that each <span class="math inline">\(A_i\)</span> is disjoint, <span class="math inline">\(\P(A_i &gt;0)\)</span>, and <span class="math inline">\(\cup A_i = \Omega\)</span>. <span class="math display">\[
\P(B) = \sum_{i=1}^{n} \P(B \cap A_i) = \sum_{i=1}^{n} \P(B \mid A_i) \P(A_i)
\]</span></p>

<img data-src="images/LTP.png" class="quarto-figure quarto-figure-center r-stretch" width="500"><div class="footer">
<p>Image from Blitzstein and Hwang (2019), Page 55</p>
</div>
</section>
<section id="bayess-rule-for-events" class="slide level2 smaller">
<h2>Bayes’s Rule for Events</h2>
<div>
<ul>
<li class="fragment">We can combine the definition of conditional probability with the LOTP to come up with Bayes’s rule for events, assuming <span class="math inline">\(\P(B) \neq 0\)</span></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\P(A \mid B) = \frac{\P(B \cap A)}{\P(B)} =
               \frac{\P(B \mid A) \P(A)}{\sum_{i=1}^{n} \P(B \mid A_i) \P(A_i)}
\]</span></p>
</div>
<ul>
<li class="fragment"><p>We typically think of <span class="math inline">\(A\)</span> is some unknown we wish to learn (e.g., the status of a disease) and <span class="math inline">\(B\)</span> as the data we observe (e.g., the result of a diagnostic test)</p></li>
<li class="fragment"><p>We call <span class="math inline">\(\P(A)\)</span> prior probability of A (e.g., how prevalent is the disease in the population)</p></li>
<li class="fragment"><p>We call <span class="math inline">\(\P(A \mid B)\)</span>, the posterior probability of the unknown <span class="math inline">\(A\)</span> given data <span class="math inline">\(B\)</span></p></li>
</ul>
</div>
</section>
<section id="estimating-pi-by-simulation" class="slide level2">
<h2>Estimating <span class="math inline">\(\pi\)</span> by Simulation</h2>
<p>The idea is that we can approximate the ratio of the area of an inscribed circle, <span class="math inline">\(A_c\)</span>, to the area of the square, <span class="math inline">\(A_s\)</span>, by uniformly “throwing darts” at the square with the side <span class="math inline">\(2r\)</span> and counting how many darts land inside the circle versus inside the square.</p>
<div class="fragment">
<p><span class="math display">\[
\begin{align}
A_{c}&amp; = \pi r^2 \\
A_{s}&amp; = (2r)^2 = 4r^2 \\
\frac{A_{c}}{A_{s}}&amp; = \frac{\pi r^2}{4r^2} = \frac{\pi}{4} \implies \pi = \frac{4A_{c}}{A_{s}}
\end{align}
\]</span></p>
</div>
</section>
<section id="estimating-pi-by-simulation-1" class="slide level2">
<h2>Estimating <span class="math inline">\(\pi\)</span> by Simulation</h2>
<p>To estimate <span class="math inline">\(\pi\)</span>, we perform the following simulation:</p>
<div class="fragment">
<p><span class="math display">\[
\begin{align}
X&amp; \sim \text{Uniform}(-1, 1) \\
Y&amp; \sim \text{Uniform}(-1, 1) \\
\pi&amp; \approx \frac{4 \sum_{i=1}^{N} \I(x_i^2 + y_i^2 &lt; 1)}{N}
\end{align}
\]</span></p>
</div>
<div class="fragment">
<p>The numerator is a sum over an indicator function <span class="math inline">\(\I\)</span>, which evaluates to <span class="math inline">\(1\)</span> if the inequality holds and <span class="math inline">\(0\)</span> otherwise.</p>
</div>
</section>
<section id="estimating-pi-by-simulation-2" class="slide level2">
<h2>Estimating <span class="math inline">\(\pi\)</span> by Simulation</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Code and Plot</a></li><li><a href="#tabset-3-2">Estimate</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb16-2"><a></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>); y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb16-3"><a></a>inside <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">1</span></span>
<span id="cb16-4"><a></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(x, y, inside)</span>
<span id="cb16-5"><a></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">data =</span> data)</span>
<span id="cb16-6"><a></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> inside)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="01-lecture-old_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center" width="288"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="fu">cat</span>(<span class="st">"Estimated value of pi ="</span>, <span class="dv">4</span><span class="sc">*</span><span class="fu">sum</span>(inside) <span class="sc">/</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated value of pi = 3.16</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">x</th>
<th style="text-align: right;">y</th>
<th style="text-align: left;">inside</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-0.8929639</td>
<td style="text-align: right;">-0.5403777</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.1237117</td>
<td style="text-align: right;">0.0664457</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.3972574</td>
<td style="text-align: right;">0.6440530</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.5569671</td>
<td style="text-align: right;">-0.9873628</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.7640633</td>
<td style="text-align: right;">-0.0044610</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="example-bayesian-analysis" class="slide level2 smaller scrollable">
<h2>Example Bayesian Analysis</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Suppose we enrolled five people in an early cancer clinical trial</li>
<li class="fragment">Each person was given an active treatment</li>
<li class="fragment">From previous trials, we have some idea of historical response rates (proportion of people responding)</li>
<li class="fragment">At the end of the trial, <span class="math inline">\(Y = y \in \{0,1,...,5 \}\)</span> people will have responded<sup>1</sup> to the treatment</li>
<li class="fragment">We are interested in estimating the probability that the response rate is greater or equal to 50%</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="images/recist.jpeg" class="quarto-figure quarto-figure-center"> Image from Fokko Smits, Martijn Dirksen, and Ivo Schoots: <a href="https://radiologyassistant.nl/more/recist-1-1/recist-1-1">RECIST 1.1 - and more</a></p>
</div></div>
<aside><ol class="aside-footnotes"><li id="fn2"><p>Partial response is a decrease in the sum of the longest diameters of target lesions of at least 30% compared to the baseline measurement.</p></li></ol></aside></section>
<section id="notation" class="slide level2 smaller">
<h2>Notation</h2>
<p>Greek letters will be used for latent parameters, and English letters will be used for observables.</p>
<div>
<ul>
<li class="fragment"><span class="math inline">\(\theta\)</span>: unknowns or parameters to be estimated; could be multivariate, discrete, and continuous (your book uses <span class="math inline">\(\pi\)</span>)</li>
<li class="fragment"><span class="math inline">\(y\)</span>: observations or measurements to be modelled (<span class="math inline">\(y_1, y_2, ...\)</span>)</li>
<li class="fragment"><span class="math inline">\(\widetilde{y}\)</span> : unobserved but observable quantities (in your book <span class="math inline">\(y'\)</span>)</li>
<li class="fragment"><span class="math inline">\(x\)</span>: covariates</li>
<li class="fragment"><span class="math inline">\(f( \theta )\)</span>: a prior model, P[DM]F of <span class="math inline">\(\theta\)</span></li>
<li class="fragment"><span class="math inline">\(f_y(y \mid \theta, x)\)</span>: an observational model, P[DM]F when it is a function of <span class="math inline">\(y\)</span> (in your book: <span class="math inline">\(f(y \mid \pi)\)</span>); we typically drop the <span class="math inline">\(x\)</span> to simplify the notation.</li>
<li class="fragment"><span class="math inline">\(f_{\theta}(y \mid \theta)\)</span>: is a likelihood function when it is a function of <span class="math inline">\(\theta\)</span> (in your book: <span class="math inline">\(\L(\pi \mid y)\)</span>)</li>
<li class="fragment">Some people write <span class="math inline">\(\L(\theta; y)\)</span> or simply <span class="math inline">\(\L(\theta)\)</span></li>
</ul>
</div>
</section>
<section id="general-approach" class="slide level2 smaller scrollable">
<h2>General Approach</h2>
<div>
<ul>
<li class="fragment">Before observing the data, we need to specify a prior model <span class="math inline">\(f(\theta)\)</span> on all unknowns <span class="math inline">\(\theta\)</span><sup>1</sup></li>
<li class="fragment">Pick a data model <span class="math inline">\(f(y \mid \theta, x)\)</span> — this is typically more important than the prior; this includes the model for the conditional mean: <span class="math inline">\(\E(y \mid x)\)</span></li>
<li class="fragment">For more complex models, we construct a prior predictive distribution, <span class="math inline">\(f(y)\)</span>
<ul>
<li class="fragment">We will define this quantity later — it will help us assess if our choice of priors makes sense on the observational scale</li>
</ul></li>
<li class="fragment">After we observe data <span class="math inline">\(y\)</span>, we treat <span class="math inline">\(f(y \mid \theta, x)\)</span> as the likelihood of observing <span class="math inline">\(y\)</span> under all plausible values of <span class="math inline">\(\theta\)</span>, conditioning on <span class="math inline">\(x\)</span> if necessary</li>
<li class="fragment">Derive a posterior model for <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\, f(\theta \mid y, x)\)</span> using Bayes’s rule or by simulation</li>
<li class="fragment">Evaluate model quality: 1) quality of the inferences; 2) quality of predictions. Revise the model if necessary</li>
<li class="fragment">Compute all the quantities of interest from the posterior, such as event probabilities, e.g., <span class="math inline">\(\P(\theta &gt; 0.5)\)</span>, posterior predictive distribution <span class="math inline">\(f(\widetilde{y} \mid y)\)</span>, decision functions, etc.</li>
</ul>
</div>
<div class="footer">
<p>For a more complete workflow, see <a href="https://arxiv.org/abs/2011.01808">Bayesian Workflow</a> by Gelman et al.&nbsp;(2020)</p>
</div>
<aside><ol class="aside-footnotes"><li id="fn3"><p>There is always a prior, even in frequentist inference.</p></li></ol></aside></section>
<section id="example-prior-model" class="slide level2 smaller">
<h2>Example Prior Model</h2>
<div>
<ul>
<li class="fragment">We will construct a prior model for our clinical trial</li>
<li class="fragment">From previous trials, we construct a discretized version of the prior distribution of the response rate</li>
<li class="fragment">The most likely value for response rate is 30%</li>
</ul>
</div>
<div class="fragment">
<div class="cell columns column-output-location" data-layout-align="center">
<div class="column">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a>dot_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb19-2"><a></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(x, y), <span class="fu">aes</span>(x, y))</span>
<span id="cb19-3"><a></a>  p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> x, </span>
<span id="cb19-5"><a></a>                     <span class="at">yend =</span> y), <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(theta)) <span class="sc">+</span> </span>
<span id="cb19-7"><a></a>    <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">f</span>(theta)))</span>
<span id="cb19-8"><a></a>}</span>
<span id="cb19-9"><a></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">0.90</span>)</span>
<span id="cb19-10"><a></a>prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.45</span>, <span class="fl">0.30</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span>)</span>
<span id="cb19-11"><a></a><span class="fu">dot_plot</span>(theta, prior) <span class="sc">+</span></span>
<span id="cb19-12"><a></a>  <span class="fu">ggtitle</span>(<span class="st">"Prior probability of response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="01-lecture-old_files/figure-revealjs/unnamed-chunk-11-1.png" class="quarto-figure quarto-figure-center" width="288"></p>
</figure>
</div>
</div>
</div></div>
</div>
<div>
<ul>
<li class="fragment">Even though <span class="math inline">\(\theta\)</span> is a continuous parameter, we can still specify a discrete prior</li>
<li class="fragment">The posterior will also be discrete and of the same cardinality</li>
</ul>
</div>
</section>
<section id="data-model" class="slide level2 smaller">
<h2>Data Model</h2>
<div>
<ul>
<li class="fragment">We consider each person’s response rate to be independent, given the treatment</li>
<li class="fragment">We have a fixed number of people in the trial, <span class="math inline">\(N = 5\)</span>, and <span class="math inline">\(0\)</span> to <span class="math inline">\(5\)</span> successes</li>
<li class="fragment">We will therefore consider: <span class="math inline">\(y | \theta \sim \text{Bin}(N,\theta) = \text{Bin}(5,\theta)\)</span></li>
<li class="fragment"><span class="math inline">\(f(y \mid \theta) = \text{Bin} (y \mid 5,\theta) = \binom{5}{y} \theta^y (1 - \theta)^{5 - y}\)</span> for <span class="math inline">\(y \in \{0,1,\ldots,5\}\)</span></li>
<li class="fragment">Is this a valid probability distribution as a function of <span class="math inline">\(y\)</span>?</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>N <span class="ot">=</span> <span class="dv">5</span>; y <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>N; theta <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb20-2"><a></a>(f_y <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> y, <span class="at">size =</span> N, <span class="at">prob =</span> theta) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a></a>    <span class="fu">fractions</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1/32 5/32 5/16 5/16 5/32 1/32</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="at">x =</span> y, <span class="at">size =</span> N, <span class="at">prob =</span> theta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="01-lecture-old_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="1536"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="likelihood-function" class="slide level2 smaller">
<h2>Likelihood Function</h2>
<div>
<ul>
<li class="fragment">We ran the trial and observed 3 out of 5 responders</li>
<li class="fragment">We can now construct a likelihood function for <span class="math inline">\(y = 3\)</span> as a function of <span class="math inline">\(\theta\)</span></li>
<li class="fragment">Let’s check if this function is a probability distribution: <span class="math display">\[
f (y) = \int_{0}^{1} \binom{N}{y} \theta^y (1 - \theta)^{N - y}\, d\theta = \frac{1}{N + 1}
\]</span></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>dbinom_theta <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, N, y) {</span>
<span id="cb24-2"><a></a>  <span class="fu">choose</span>(N, y) <span class="sc">*</span> theta<span class="sc">^</span>y <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span>(N <span class="sc">-</span> y) </span>
<span id="cb24-3"><a></a>}</span>
<span id="cb24-4"><a></a><span class="fu">integrate</span>(dbinom_theta, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>, </span>
<span id="cb24-5"><a></a>          <span class="at">N =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">3</span>)[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> <span class="fu">fractions</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1/6</code></pre>
</div>
</div>
</div>
<div>
<ul>
<li class="fragment"><span class="math inline">\(f(y)\)</span> is called marginal distribution of the data or, more aptly, prior predictive distribution</li>
<li class="fragment">It tells us that prior to observing <span class="math inline">\(y\)</span>, all values of <span class="math inline">\(y\)</span> are equally likely</li>
</ul>
</div>
</section>
<section id="likelihood-function-1" class="slide level2 smaller">
<h2>Likelihood Function</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="01-lecture-old_files/figure-revealjs/unnamed-chunk-15-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="fragment">
<p>Compare with the data model:</p>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="01-lecture-old_files/figure-revealjs/unnamed-chunk-16-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="compute-the-posterior" class="slide level2 smaller">
<h2>Compute the Posterior</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment">Compute the likelihood
<ul>
<li class="fragment"><span class="math inline">\(\binom{5}{3} \theta^3 (1 - \theta)^{2}\)</span> for <span class="math inline">\(\theta \in \{0.10, 0.30, 0.50, 0.70, 0.90\}\)</span></li>
</ul></li>
<li class="fragment">Multiply the likelihood by the prior to compute the numerator
<ul>
<li class="fragment"><span class="math inline">\(f(y = 3 \mid \theta) f(\theta)\)</span></li>
</ul></li>
<li class="fragment">Sum the numerator to get the marginal likelihood
<ul>
<li class="fragment"><span class="math inline">\(f(y = 3) = \\ \sum_{\theta} f(y = 3 | \theta) f(\theta) \approx 0.2\)</span></li>
</ul></li>
<li class="fragment">Finally, compute the posterior
<ul>
<li class="fragment"><span class="math inline">\(f(\theta \mid y = 3) = \frac{f(y = 3 \mid \theta) f(\theta)}{\sum_{\theta} f(y = 3 | \theta) f(\theta)}\)</span></li>
</ul></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>N <span class="ot">&lt;-</span> <span class="dv">5</span>; y <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb26-2"><a></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">0.90</span>)</span>
<span id="cb26-3"><a></a>prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.45</span>, <span class="fl">0.30</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span>)</span>
<span id="cb26-4"><a></a>lik <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(y, N, theta)</span>
<span id="cb26-5"><a></a>lik_x_prior <span class="ot">&lt;-</span>  lik <span class="sc">*</span> prior</span>
<span id="cb26-6"><a></a>constant <span class="ot">&lt;-</span> <span class="fu">sum</span>(lik_x_prior)</span>
<span id="cb26-7"><a></a>post <span class="ot">&lt;-</span> lik_x_prior <span class="sc">/</span> constant</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><br></p>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="lightable-paper caption-top" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">theta</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">prior</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lik</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lik_x_prior</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.1</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.05</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.01</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.00</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.3</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.45</td>
<td style="text-align: right; color: white !important; background-color: rgba(53, 95, 141, 255) !important;">0.13</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 62, 133, 255) !important;">0.06</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 62, 133, 255) !important;">0.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right; color: white !important; background-color: rgba(66, 64, 134, 255) !important;">0.30</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.31</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.09</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.7</td>
<td style="text-align: right; color: white !important; background-color: rgba(44, 113, 142, 255) !important;">0.15</td>
<td style="text-align: right; color: white !important; background-color: rgba(69, 3, 86, 255) !important;">0.31</td>
<td style="text-align: right; color: white !important; background-color: rgba(58, 83, 139, 255) !important;">0.05</td>
<td style="text-align: right; color: white !important; background-color: rgba(58, 83, 139, 255) !important;">0.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.9</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.05</td>
<td style="text-align: right; color: white !important; background-color: rgba(42, 119, 142, 255) !important;">0.07</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 140, 141, 255) !important;">0.00</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 140, 141, 255) !important;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">Total</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">1.00</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">0.83</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">0.20</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">1.00</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</div></div>
</section>
<section id="computing-event-probability" class="slide level2 smaller">
<h2>Computing Event Probability</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li class="fragment"><p>To compute event probabilities, we integrate (or sum) the relevant regions of the parameter space <span class="math display">\[
\P(\theta \geq 0.5) = \int_{0.5}^{1} f(\theta \mid y) \, d\theta
\]</span></p></li>
<li class="fragment"><p>In this case, we only have discrete quantities, so we sum:</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a>probs <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a></a>  <span class="fu">filter</span>(theta <span class="sc">&gt;=</span> <span class="fl">0.50</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(prior, post) <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a></a>  <span class="fu">colSums</span>() <span class="sc">|&gt;</span></span>
<span id="cb27-5"><a></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb27-6"><a></a>probs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prior  post 
 0.50  0.71 </code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="lightable-paper caption-top" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">theta</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">prior</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lik</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lik_x_prior</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.1</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.05</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.01</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.00</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.3</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.45</td>
<td style="text-align: right; color: white !important; background-color: rgba(53, 95, 141, 255) !important;">0.13</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 62, 133, 255) !important;">0.06</td>
<td style="text-align: right; color: white !important; background-color: rgba(67, 62, 133, 255) !important;">0.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right; color: white !important; background-color: rgba(66, 64, 134, 255) !important;">0.30</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.31</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.09</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.7</td>
<td style="text-align: right; color: white !important; background-color: rgba(44, 113, 142, 255) !important;">0.15</td>
<td style="text-align: right; color: white !important; background-color: rgba(69, 3, 86, 255) !important;">0.31</td>
<td style="text-align: right; color: white !important; background-color: rgba(58, 83, 139, 255) !important;">0.05</td>
<td style="text-align: right; color: white !important; background-color: rgba(58, 83, 139, 255) !important;">0.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.9</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important;">0.05</td>
<td style="text-align: right; color: white !important; background-color: rgba(42, 119, 142, 255) !important;">0.07</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 140, 141, 255) !important;">0.00</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 140, 141, 255) !important;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">Total</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">1.00</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">0.83</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">0.20</td>
<td style="text-align: right; color: white !important; background-color: rgba(33, 144, 140, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">1.00</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p><br></p>
<div>
<ul>
<li class="fragment"><span class="math inline">\(\P(\theta \geq 0.50) =\)</span> 0.5 and <span class="math inline">\(\P(\theta | y \geq 0.50) =\)</span> 0.71</li>
</ul>
</div>
</div></div>
</section>
<section id="what-if-we-used-a-flat-prior" class="slide level2 smaller">
<h2>What If We Used a Flat Prior?</h2>
<div>
<ul>
<li class="fragment">Flat or uniform prior means that we consider all values of <span class="math inline">\(\theta\)</span> equality likely</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a>N <span class="ot">&lt;-</span> <span class="dv">5</span>; y <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb29-2"><a></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.30</span>, <span class="fl">0.50</span>, <span class="fl">0.70</span>, <span class="fl">0.90</span>)</span>
<span id="cb29-3"><a></a>prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>)</span>
<span id="cb29-4"><a></a>lik <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(y, N, theta)</span>
<span id="cb29-5"><a></a>lik_x_prior <span class="ot">&lt;-</span>  lik <span class="sc">*</span> prior</span>
<span id="cb29-6"><a></a>constant <span class="ot">&lt;-</span> <span class="fu">sum</span>(lik_x_prior)</span>
<span id="cb29-7"><a></a>post <span class="ot">&lt;-</span> lik_x_prior <span class="sc">/</span> constant</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="lightable-paper caption-top" data-quarto-postprocess="true" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">theta</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">prior</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lik</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lik_x_prior</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.1</td>
<td style="text-align: right; color: white !important; background-color: rgba(52, 96, 141, 255) !important;">0.2</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 168, 132, 255) !important;">0.01</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 168, 132, 255) !important;">0.00</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 168, 132, 255) !important;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.3</td>
<td style="text-align: right; color: white !important; background-color: rgba(52, 96, 141, 255) !important;">0.2</td>
<td style="text-align: right; color: white !important; background-color: rgba(46, 110, 142, 255) !important;">0.13</td>
<td style="text-align: right; color: white !important; background-color: rgba(46, 110, 142, 255) !important;">0.03</td>
<td style="text-align: right; color: white !important; background-color: rgba(46, 110, 142, 255) !important;">0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: right; color: white !important; background-color: rgba(52, 96, 141, 255) !important;">0.2</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.31</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.06</td>
<td style="text-align: right; color: white !important; background-color: rgba(68, 1, 84, 255) !important;">0.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.7</td>
<td style="text-align: right; color: white !important; background-color: rgba(52, 96, 141, 255) !important;">0.2</td>
<td style="text-align: right; color: white !important; background-color: rgba(69, 4, 87, 255) !important;">0.31</td>
<td style="text-align: right; color: white !important; background-color: rgba(69, 4, 87, 255) !important;">0.06</td>
<td style="text-align: right; color: white !important; background-color: rgba(69, 4, 87, 255) !important;">0.37</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.9</td>
<td style="text-align: right; color: white !important; background-color: rgba(52, 96, 141, 255) !important;">0.2</td>
<td style="text-align: right; color: white !important; background-color: rgba(35, 138, 141, 255) !important;">0.07</td>
<td style="text-align: right; color: white !important; background-color: rgba(35, 138, 141, 255) !important;">0.01</td>
<td style="text-align: right; color: white !important; background-color: rgba(35, 138, 141, 255) !important;">0.09</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">Total</td>
<td style="text-align: right; color: white !important; background-color: rgba(52, 96, 141, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">1.0</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 168, 132, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">0.83</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 168, 132, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">0.17</td>
<td style="text-align: right; color: white !important; background-color: rgba(34, 168, 132, 255) !important; color: black !important; background-color: rgba(240, 241, 235, 255) !important;">1.00</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="fragment">

</div>
<div>
<ul>
<li class="fragment"><span class="math inline">\(\P(\theta \geq 0.50) =\)</span> 0.6 and <span class="math inline">\(\P(\theta | y \geq 0.50) =\)</span> 0.83</li>
</ul>
</div>
</section>
<section id="bayesian-workflow" class="slide level2 smaller">
<h2>Bayesian Workflow</h2>

<img data-src="images/workflow.png" class="quarto-figure quarto-figure-center r-stretch" width="672"><div class="footer">
<p>Gelman, A. et al.&nbsp;(2020). Bayesian Workflow. ArXiv:2011.01808 [Stat]. http://arxiv.org/abs/2011.01808</p>
</div>
</section>
<section id="overview-of-the-class" class="slide level2">
<h2>Overview of the class</h2>
<ul>
<li><a href="https://ericnovik.github.io/bayes-course/syllabus.pdf">Syllabus</a></li>
</ul>


</section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="https://ericnovik.github.io/bayes-course.html" class="uri">https://ericnovik.github.io/bayes-course.html</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false,"chalkWidth":5},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/ericnovik\.github\.io\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>